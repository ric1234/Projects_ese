################################################################################################
Names: 	Richard Noronha 
	Omkar Purandare

Subject: ECEN5013 Fall2016

University of Colorado Boulder

Date: 9/18/2016

#################################################################################################

#================================================================================================
This file describes the Build system in detail.

All the necessary files are saved in the same directory. The names of the files is saved in the header file called sources.mk. This file includes all the header files present in the directory as well as the the source files. Two variables have been declared to save the names of the files.

#================================================================================================
The sources.mk file is included in the Makefile. The variable within the source file can be called from the Makefile as it is already included. 

The different types of files that are generated during the execution of the Makefile are strored in the variables. These variables are dependent on other variables. These file variables call the targets and the corresponding file is generated one at a time. Therefore, these variables can be considered as the array of files which might be called by other variables. 

The other types of variables are defined after these files. 

The test condition checks the value of the variable of arch which is given on the commandline. The Compiler is then chosen as per the requirements. For example if the code has to be generated for the host machine, the the variable arch is set to host. For the Beagle Bone Black, it is given by bbb and frdm for the Freescale kl25z board.
The utilities such as size and objcpy are different based on the board the executable has to run on. Therefore, we can set the size variable based on the same test condition.

The targets are then specified. The default target is all. This target runs the build target by default. As the default compiler is set to the host, the build target generates the project executable.

The preprocess target is used to generate the output of the -E flag. These are the preprocessed files and have the .i file. The preprocess file and most of the rest of the targets use the Autovaribles of the Makefile. This enables us to execute the function for multiple files not just a single file. 

The %.i if called separately in the command file generates the .s file individually. We can call the %.i target by typing <filename>.i in the commandline after make. For example, make memory.i 

Similarly, for the assembler files and the object files, all the assembler files can be generated with the asm-file target and the object files from the compile-all target. The individual files can also be generated in a similar fashion. 

The compile-all target does not link the files but only compiles all the files. The compiler might give a warning as the files have not been linked. The build target on the other hand not only compiles the files but also links them. For linking the files, the Include files are a prerequisites. These header files are not needed before the linking stage and hence not given as prerequisites for the previous targets.

The size_of_file target can be used to give the size of the executable generated by the build target. 

The target upload is used when the executable file project is to be uploaded to the Beagle Bone Black. The scp command is used to copy the source file to the destination folder on the directory specified.
#PLEASE NOTE: THE IP MIGHT HAVE TO MODIFIED TO THE ONE ASSIGNED TO THE BEAGLE BONE BY THE ROUTER USED.#

The clean is one of the common targets in Makefiles and is used to delete the intermediate files generated during the make.

The build-lib is used to build the archive from the two .c files. The c flag is used to create the archive and the -r is used to insert the specified files. If the files are modified, the -r will replace them on the archive when the build-lib target is made.

#================================================================================================
#================================================================================================
				Examples:
make: - runs the build target and size-of-files target and generates the executable file for the 
	host machine

make preprocess: - generates ALL the preprocessed files	(.i extension)

make main.i :- generates the main.i file only

make asm-file: - generates ALL the assembler files(.s extension)	

make main.s :- generates the main.s file only

make compile-all :- generates ALL the object files (.o extension)

make main.o :- generates the main.o file only

make build:- generates and links the object files and creates the executable project

make clean:- cleans all the intermediate files

make build-lib:- generates the archive of memeory.c and data.c

make arch=bbb: Compiles the code for the Beagle Bone black

make arch=frdm: Compiles the code for the FRDM KL25z

#================================================================================================







